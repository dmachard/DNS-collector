# Collector: DNStap

## DNS tap

Collector to logging DNStap stream from DNS servers.
The traffic can be a tcp or unix DNStap stream. TLS is also supported.

Options:

- `listen-ip` (str) local address to bind to.
  > Set the local address that the server will bind to. If not provided, the server will bind to all available network interfaces (0.0.0.0).
- `listen-port` (int) local port to bind to.
  > Set the local port that the server will listen on. If not provided, use the default port.
- `sock-path` (str) Unix socket path.
  > Specify the path for the Unix socket to be created.
- `tls-support` (bool) set to true to enable TLS.
  > Enables or disables TLS (Transport Layer Security) support. If set to true, TLS will be used for secure communication.
- `tls-min-version` (str) Minimun TLS version to use.
  > Specifies the minimum TLS version that the server will support.
- `cert-file` (str) path to a certificate server file to use.
  > Specifies the path to the certificate file to be used for TLS. This is a required parameter if TLS support is enabled.
- `key-file`(str) path to a key server file to use.
  > Specifies the path to the key file corresponding to the certificate file. This is a required parameter if TLS support is enabled.
- `sock-rcvbuf` (int) sets the socket receive buffer in bytes SO_RCVBUF.
  > This advanced parameter allows fine-tuning of network performance by adjusting the amount of data the socket can receive before signaling to the sender to slow down.
  > Set to zero to use the default system value.
- `reset-conn` (bool) reset TCP connection on exit.
  > Set whether to send a TCP Reset to force the cleanup of the connection on the remote side when the server exits.
- `chan-buffer-size` (int) incoming channel size, number of packet before to drop it.
  > Specifies the maximum number of packets that can be buffered before dropping additional packets.
- `disable-dnsparser"` (bool) disable the minimalist DNS parser.
  > Some JSON keys should not be available, such as `dns.id`, `dns.flags`, ...
- `extended-support` (bool) decode the extended extra field sent by DNScollector. 
  > If this setting is enabled, DNScollector will expect receiving the specific [protobuf structure](./../../dnsutils/extended_dnstap.proto) in the extra field, which must be sent by another DNS collector.
  > This field will contain additional metadata generated by various transformations such as filtering, ATags, and others.

Defaults:

```yaml
- name: dnstap
  dnstap:
    listen-ip: 0.0.0.0
    listen-port: 6000
    sock-path: null
    tls-support: false
    tls-min-version: 1.2
    cert-file: ""
    key-file: ""
    sock-rcvbuf: 0
    reset-conn: true
    chan-buffer-size: 65535
    disable-dnsparser: true
    extended-support: false
```

## DNS tap Proxifier

Collector that receives DNSTAP traffic and relays it without decoding or transformations.
This collector must be used with the DNStap logger.

Dnstap stream collector can be a tcp or unix socket listener. TLS is also supported.

For config examples, take a look to the following [one](../_examples/use-case-12.yml)

Options:

- `listen-ip` (str) local address to bind to.
  > Set the local address that the server will bind to. If not provided, the server will bind to all available network interfaces (0.0.0.0).
- `listen-port` (int) local port to bind to.
  > Set the local port that the server will listen on. If not provided, use the default port.
- `sock-path` (str) Unix socket path.
  > Specify the path for the Unix socket to be created.
- `tls-support` (bool) set to true to enable TLS.
  > Enables or disables TLS (Transport Layer Security) support. If set to true, TLS will be used for secure communication.
- `tls-min-version` (str) Minimun TLS version to use.
  > Specifies the minimum TLS version that the server will support.
- `cert-file` (str) path to a certificate server file to use.
  > Specifies the path to the certificate file to be used for TLS. This is a required parameter if TLS support is enabled.
- `key-file`(str) path to a key server file to use.
  > Specifies the path to the key file corresponding to the certificate file. This is a required parameter if TLS support is enabled.

Defaults

```yaml
- name: relay
  dnstap-relay:
    listen-ip: 0.0.0.0
    listen-port: 6000
    sock-path: null
    tls-support: false
    tls-min-version: 1.2
    cert-file: ""
    key-file: ""
```
