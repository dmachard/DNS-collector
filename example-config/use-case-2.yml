# Example 2: Get statistics usage with Prometheus and Grafana
#
# As prerequisites, we assume you have a DNS server which supports DNSTap (unbound, bind, powerdns, etc)
# For more informations about dnstap, read the following page: https://dmachard.github.io/posts/0001-dnstap-testing/
#

global:
  trace:
    verbose: true

multiplexer:
  collectors:
    # listen on tcp/6000 for incoming DNSTap protobuf messages
    - name: tap
      dnstap:
        listen-ip: 0.0.0.0
        listen-port: 6000

  loggers:
    # expose prometheus metrics
    - name: prom
      prometheus:
        listen-ip: 0.0.0.0
        listen-port: 8080

  routes:
    # redirect DNS messages from the tap collector to the Prometheus logger
    - from: [tap]
      to: [prom]